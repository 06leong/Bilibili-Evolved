(()=>{return(e,o)=>{const n={include:["//www.bilibili.com/video/","//www.bilibili.com/bangumi/"]};const t="showCoverBeforePlayStyle";let r;const i=()=>{const e=async()=>{if(n.include.every(e=>!document.URL.includes(e))){return}o.applyStyle(t);const e=await SpinQuery.select(()=>unsafeWindow.aid);if(!e){console.warn("[播放前显示封面] 未找到av号");return}if(e===r){return}r=e;const i=await SpinQuery.select("video");if(!i){console.warn("[播放前显示封面] 未找到视频");return}if(!i.paused){return}const{VideoInfo:l}=await o.importAsync("video-info");const c=new l(e);await c.fetchInfo();document.body.style.setProperty("--cover-url",`url('${c.coverUrl}')`);i.addEventListener("play",()=>{document.body.style.removeProperty("--cover-url")},{once:true})};e()};i();return{reload:()=>o.applyStyle(t),unload:()=>o.removeStyle(t)}}})();