(()=>{return(t,a)=>{const d=t=>{return{url:t.downloadUrl,backupUrls:t.backupUrls,length:t.duration,size:Math.trunc(t.bandWidth*t.duration/8)}};const r=async(t,a)=>{const d=await Ajax.getJsonWithCredentials(t);const r=d.data||d.result||d;if(d.code!==0||!r.dash){throw new Error("DASH api failed")}const e=r.accept_quality;if(!e.includes(a)){throw new Error("没有找到请求的清晰度")}if(r.quality!==a){throw new Error("无法获取请求的清晰度, 请确认当前账号有相应的权限")}const o=r.accept_description;const n=o[e.indexOf(a)];const c=r.dash.duration;const i=r.dash.video.filter(t=>t.id===a).map(t=>{const d={quality:a,qualityText:n,width:t.width,height:t.height,codecs:t.codecs,codecId:t.codecid,bandWidth:t.bandwidth,frameRate:t.frameRate,backupUrls:t.backupUrl,downloadUrl:t.baseUrl,duration:c};return d});const s=r.dash.audio.map(t=>{return{bandWidth:t.bandwidth,codecs:t.codecs,codecId:t.codecid,backupUrls:t.backupUrl,downloadUrl:t.baseUrl,duration:c}});return{videoDashes:i,audioDashes:s}};return{export:{getDashInfo:r,dashToFragment:d}}}})();